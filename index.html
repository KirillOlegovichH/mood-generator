<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</title>
  <!-- –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è body –∏ —Ñ–æ–Ω–∞ */
    body {
      background: linear-gradient(135deg, #cad4fd 0%, #222223 100%);
      color: #2c3e50;
      font-family: 'Segoe UI', 'Apple Color Emoji', sans-serif;
      display: flex
  ;
      flex-direction: column;
      align-items: center;
      margin: 40px 0;
      height: 100vh;
      overflow: hidden;
      transition: background 1s ease;
      justify-content: flex-start;
      overflow: hidden;
      transition: background 1s ease;
    }
    h1 {
      letter-spacing: 1.5px;
      font-weight: 700;
      font-size: 1.4em;
      margin-bottom: 3vw;
      color: #ffffff;
      text-align: center;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    .slots {
      display: flex;
      gap: 1.5vw;
      margin-bottom: 3vw;
    }
    .slot {
      width: 90px;
      height: 90px;
      border: 2px solid rgba(255, 255, 255, 0.4);
      border-radius: 20px;
      font-size: 3.2em;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, rgb(159 161 175), rgb(104 73 137));
      transition: all 0.3s ease;
      filter: grayscale(0.5);
      box-shadow: 
        0 4px 15px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    .slot.active {
      box-shadow: 0 0 25px rgba(255,255,255,0.6);
      transform: scale(1.05);
    }
    .slot.finished {
      filter: none;
      box-shadow: 
        0 8px 25px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.4);
    }
    .btn-container {
      position: fixed;
      text-align: center;
      left: 0%;
      bottom: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 0;
      width: 100%;
      height: max-content;
      z-index: 10;
      pointer-events: none;
    }
    #spin {
      background: rgba(255, 255, 255, 0.2);
      color: #333;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      width: 120px;
      height: 120px;
      font-size: 0;
      cursor: pointer;
      z-index: 2;
      position: relative;
      transition: all 0.3s ease;
      pointer-events: auto;
      box-shadow: 
        0 4px 15px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
    }
    #spin::before {
      content: "üé∞";
      font-size: 2.5em;
      transition: all 0.2s ease;
      opacity: 0.8;
    }
    #spin:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-5px) scale(1.05);
      box-shadow: 
        0 8px 20px rgba(0,0,0,0.2),
        inset 0 2px 0 rgba(255,255,255,0.5);
    }
    #spin:hover::before {
      opacity: 1;
    }
    #spin:active {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px) scale(0.98);
      box-shadow: 
        0 3px 10px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    .hidden {
      opacity: 0;
      pointer-events: none;
    }
    .emoji-burst {
      position: fixed;
      left: 50%;
      bottom: 120px;
      font-size: 2.2em;
      pointer-events: none;
      opacity: 0;
      filter: grayscale(1) !important;
      animation: burstUp 1s cubic-bezier(.23,1.42,.54,1) forwards;
      z-index: 20;
    }
    @keyframes burstUp {
      0% {
        opacity: 1;
        transform: translate(-50%, 0) scale(1) rotate(0deg);
      }
      60% {
        opacity: 1;
        transform: translate(calc(-50% + var(--x)), calc(-1 * var(--y))) scale(1.4) rotate(var(--r));
      }
      100% {
        opacity: 0;
        transform: translate(calc(-50% + var(--x)), calc(-1 * (var(--y) + 150px))) scale(0.6) rotate(calc(var(--r) * 1.5));
      }
    }
    /* –ù–æ–≤–∞—è –ø–ª–∞—à–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
    .result-container {
      margin: 3vw 25px 0 25px;
      max-width: calc(100vw - 50px);
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s ease;
    }
    .result-container.show {
      opacity: 1;
      visibility: visible;
      animation: resultSlideIn 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    @keyframes resultSlideIn {
      0% {
        opacity: 0;
        transform: translateY(30px) scale(0.8);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    .result-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 24px;
      padding: 1.5em 2em;
      box-shadow: 
        0 8px 32px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.2);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .result-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer {
      0% { left: -100%; }
      50% { left: 100%; }
      100% { left: 100%; }
    }
    .mood-level {
      font-size: 0.9em;
      color: rgba(255,255,255,0.8);
      margin-bottom: 0.5em;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .mood-text {
      font-size: 1.4em;
      color: #ffffff;
      font-weight: 700;
      margin-bottom: 0.3em;
      text-shadow: 0 2px 8px rgba(0,0,0,0.5);
      line-height: 1.2;
      /* –¢–µ–∫—Å—Ç —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã */
      text-transform: capitalize;
    }
    .mood-indicator {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 0.8em;
      gap: 0.3em;
    }
    .mood-emoji {
      font-size: 2em;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.3));
      min-width: 64px;
      min-height: 64px;
      height: 64px;
      width: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      position: relative;
    }
    .mood-emoji .emoji-loader {
      display: inline-block;
      width: 44px;
      height: 44px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top: 4px solid #fff;
      border-radius: 50%;
      animation: emojiSpin 0.8s linear infinite;
      vertical-align: middle;
      margin: 0 auto;
    }
    @keyframes emojiSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .rarity-badge {
      display: inline-block;
      padding: 0.3em 0.8em;
      border-radius: 12px;
      font-size: 0.8em;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 0.5em;
    }
    .rarity-common {
      background: rgba(108, 117, 125, 0.3);
      color: #ffffff;
      border: 1px solid rgba(108, 117, 125, 0.5);
    }
    .rarity-rare {
      background: rgba(40, 167, 69, 0.3);
      color: #ffffff;
      border: 1px solid rgba(40, 167, 69, 0.5);
    }
    .rarity-epic {
      background: rgba(138, 43, 226, 0.3);
      color: #ffffff;
      border: 1px solid rgba(138, 43, 226, 0.5);
    }
    .rarity-legendary {
      background: rgba(255, 193, 7, 0.3);
      color: #ffffff;
      border: 1px solid rgba(255, 193, 7, 0.5);
      box-shadow: 0 0 15px rgba(255, 193, 7, 0.3);
    }
    
    /* NFT Mint Button */
    .mint-button-container {
      margin-top: 1em;
      /* –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
      display: none;
    }
    .mint-button-container.show {
      display: block;
      animation: mintButtonSlideIn 0.5s ease-out;
    }
    @keyframes mintButtonSlideIn {
      0% {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    .mint-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 16px;
      padding: 0.8em 1.5em;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      box-shadow: 
        0 4px 15px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      margin: 0 auto;
      max-width: 200px;
      position: relative;
      overflow: hidden;
    }
    .mint-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }
    .mint-button:hover {
      background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
      transform: translateY(-2px);
      box-shadow: 
        0 6px 20px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    .mint-button:hover::before {
      left: 100%;
    }
    .mint-button:active {
      transform: translateY(0);
      box-shadow: 
        0 2px 10px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.1);
    }
    .mint-button.processing {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      cursor: not-allowed;
      pointer-events: none;
    }
    .mint-button.processing::after {
      content: '';
      width: 16px;
      height: 16px;
      border: 2px solid transparent;
      border-top: 2px solid #ffffff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 0.5em;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @media (max-width: 600px) {
      h1 {
        font-size: 1.2em;
        letter-spacing: 1px;
        margin-bottom: 4vw;
      }
      .result-container {
        margin: 3vw 20px 0 20px;
        max-width: calc(100vw - 40px);
      }
      .result-card {
        padding: 1.2em 1.5em;
      }
      .mood-text {
        font-size: 1.2em;
      }
      .mood-emoji {
        font-size: 2.6em;
      }
      .slot {
        width: 100px;
        height: 100px;
        font-size: 3.6em;
      }
      button {
        width: 100px;
        height: 100px;
      }
      button::before {
        font-size: 2em;
      }
      .mint-button {
        padding: 0.7em 1.2em;
        font-size: 0.8em;
        max-width: 180px;
      }
    }
    @media (max-width: 400px) {
      h1 {
        font-size: 1em;
        letter-spacing: 0.5px;
      }
    }
    .credits {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 0.9em;
      color: rgba(255,255,255,0.7);
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    }

    /* 6. CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏—è */
    .emoji-fusion {
      animation: fusionPop 0.5s cubic-bezier(.4,2,.6,1) 1;
    }
    @keyframes fusionPop {
      0% { transform: scale(0.2) rotate(-60deg); opacity: 0; }
      60% { transform: scale(1.2) rotate(30deg); opacity: 0.7; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    /* --- Fusion Loader --- */
    .emoji-fusion-loader {
      position: relative;
      width: 64px;
      height: 64px;
      display: inline-block;
      vertical-align: middle;
      margin: 0 auto;
    }
    .fusion-emoji {
      position: absolute;
      top: 50%;
      font-size: 1.5em;
      opacity: 0.8;
      transform: translateY(-50%);
      transition: none;
      will-change: transform, opacity;
      pointer-events: none;
    }
    .fusion-emoji.left {
      left: 0;
      animation: fusion-move-left 0.9s cubic-bezier(.7,2,.3,1) forwards;
    }
    .fusion-emoji.right {
      right: 0;
      animation: fusion-move-right 0.9s cubic-bezier(.7,2,.3,1) forwards;
    }
    @keyframes fusion-move-left {
      0% { transform: translateY(-50%) translateX(0); opacity: 0.8; }
      80% { transform: translateY(-50%) translateX(20px); opacity: 0.8; }
      100% { transform: translateY(-50%) translateX(20px); opacity: 0; }
    }
    @keyframes fusion-move-right {
      0% { transform: translateY(-50%) translateX(0); opacity: 0.8; }
      80% { transform: translateY(-50%) translateX(-20px); opacity: 0.8; }
      100% { transform: translateY(-50%) translateX(-20px); opacity: 0; }
    }
    .fusion-magic {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 38px;
      height: 38px;
      transform: translate(-50%, -50%) scale(0.5);
      border-radius: 50%;
      background: radial-gradient(circle, #fffbe6 0%, #ffe066 40%, #ffd700 70%, transparent 100%);
      opacity: 0;
      pointer-events: none;
      box-shadow: 0 0 24px 8px #ffe066, 0 0 60px 20px #fffbe6;
      animation: fusion-magic-flash 0.45s 0.75s cubic-bezier(.7,2,.3,1) forwards;
      z-index: 2;
    }
    @keyframes fusion-magic-flash {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
      60% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
    }
  </style>
</head>
<body>
  <h1>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</h1>
  <!-- –°–ª–æ—Ç—ã –¥–ª—è —ç–º–æ–¥–∑–∏ -->
  <div class="slots">
    <div class="slot" id="slot1">ü§î</div>
    <div class="slot" id="slot2">ü§î</div>
    <div class="slot" id="slot3">ü§î</div>
  </div>
  <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ -->
  <div class="btn-container">
    <div id="spin"></div>
  </div>
  <!-- –ë–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
  <div class="result-container" id="resultContainer">
    <div class="result-card">
      <div class="mood-level" id="moodLevel">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
      <div class="mood-indicator">
        <span class="mood-emoji" id="moodEmoji">üé≠</span>
      </div>
      <div class="mood-text" id="moodText">–¢–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ...</div>
      <div class="rarity-badge" id="rarityBadge">–û–±—ã—á–Ω–æ–µ</div>
      
      <!-- NFT Mint Button -->
      <div class="mint-button-container" id="mintButtonContainer">
        <button class="mint-button" id="mintButton">
          <span>üé® –°–æ–∑–¥–∞—Ç—å NFT</span>
        </button>
      </div>
    </div>
  </div>
  <div class="credits">by KirillOlegovichH</div>
  <script>
    // –ú–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–º–∞–π–ª—É —Å —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ —ç–º–æ—Ü–∏–π
    const emojiData = [
      // –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 4-5)
      {
        emoji: "üòÄ",
        gradient: ["#FFE135", "#FFA726"],
        moodParts: ["—Ä–∞–¥–æ—Å—Ç–Ω–æ", "—Ä–∞–¥–æ—Å—Ç–Ω–æ", "—Ä–∞–¥–æ—Å—Ç–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "üòÉ",
        gradient: ["#FF6B6B", "#FF8E53"],
        moodParts: ["–≤–µ—Å–µ–ª–æ", "–≤–µ—Å–µ–ª–æ", "–≤–µ—Å—ë–ª–æ–µ"],
        rating: 5
      },
      {
        emoji: "üòÑ",
        gradient: ["#4ECDC4", "#44A08D"],
        moodParts: ["—Å—á–∞—Å—Ç–ª–∏–≤–æ", "—Å—á–∞—Å—Ç–ª–∏–≤–æ", "—Å—á–∞—Å—Ç–ª–∏–≤–æ–µ"],
        rating: 5
      },
      {
        emoji: "üòÅ",
        gradient: ["#A8E6CF", "#7FCDCD"],
        moodParts: ["–ª–∏–∫—É—é—â–µ", "–ª–∏–∫—É—é—â–µ", "–ª–∏–∫—É—é—â–µ–µ"],
        rating: 5
      },
      {
        emoji: "üòÜ",
        gradient: ["#FFB347", "#FFCC02"],
        moodParts: ["—Å–º–µ—à–ª–∏–≤–æ", "—Å–º–µ—à–ª–∏–≤–æ", "—Å–º–µ—à–ª–∏–≤–æ–µ"],
        rating: 4
      },
      {
        emoji: "üòÇ",
        gradient: ["#F093FB", "#F5576C"],
        moodParts: ["–∏—Å—Ç–µ—Ä–∏—á–Ω–æ", "–∏—Å—Ç–µ—Ä–∏—á–Ω–æ", "–∏—Å—Ç–µ—Ä–∏—á–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "ü§£",
        gradient: ["#4FC3F7", "#29B6F6"],
        moodParts: ["—Ö–æ—Ö–æ—á—É—â–µ", "—Ö–æ—Ö–æ—á—É—â–µ", "—Ö–æ—Ö–æ—á—É—â–µ–µ"],
        rating: 5
      },
      {
        emoji: "üòä",
        gradient: ["#FFECD2", "#FCB69F"],
        moodParts: ["–ø—Ä–∏—è—Ç–Ω–æ", "–ø—Ä–∏—è—Ç–Ω–æ", "–ø—Ä–∏—è—Ç–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "üòá",
        gradient: ["#E0C3FC", "#9BB5FF"],
        moodParts: ["–∞–Ω–≥–µ–ª—å—Å–∫–∏", "–∞–Ω–≥–µ–ª—å—Å–∫–∏", "–∞–Ω–≥–µ–ª—å—Å–∫–æ–µ"],
        rating: 5
      },
      {
        emoji: "üôÇ",
        gradient: ["#A8CABA", "#5D9E7F"],
        moodParts: ["–º–∏–ª–æ", "–º–∏–ª–æ", "–º–∏–ª–æ–µ"],
        rating: 4
      },
      {
        emoji: "üòç",
        gradient: ["#FF7675", "#E17055"],
        moodParts: ["–≤–ª—é–±–ª—ë–Ω–Ω–æ", "–≤–ª—é–±–ª—ë–Ω–Ω–æ", "–≤–ª—é–±–ª—ë–Ω–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "ü•∞",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["–æ–±–æ–∂–∞—é—â–µ", "–æ–±–æ–∂–∞—é—â–µ", "–æ–±–æ–∂–∞—é—â–µ–µ"],
        rating: 5
      },
      {
        emoji: "ü§©",
        gradient: ["#A29BFE", "#6C5CE7"],
        moodParts: ["–∑–≤—ë–∑–¥–Ω–æ", "–∑–≤—ë–∑–¥–Ω–æ", "–∑–≤—ë–∑–¥–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "ü•≥",
        gradient: ["#FF7675", "#E17055"],
        moodParts: ["–ø—Ä–∞–∑–¥–∏—á–Ω–æ", "–ø—Ä–∞–∑–¥–∏—á–Ω–æ", "–ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "üòé",
        gradient: ["#2D3436", "#636E72"],
        moodParts: ["–∫—Ä—É—Ç–æ", "–∫—Ä—É—Ç–æ", "–∫—Ä—É—Ç–æ–µ"],
        rating: 4
      },
      {
        emoji: "üëç",
        gradient: ["#00B894", "#55A3FF"],
        moodParts: ["–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ", "–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ", "–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ–µ"],
        rating: 4
      },
      
      // –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 3)
      {
        emoji: "üôÉ",
        gradient: ["#FD79A8", "#FDCB6E"],
        moodParts: ["–ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ", "–ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ", "–ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòâ",
        gradient: ["#6C5CE7", "#A29BFE"],
        moodParts: ["–∏–≥—Ä–∏–≤–æ", "–∏–≥—Ä–∏–≤–æ", "–∏–≥—Ä–∏–≤–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòå",
        gradient: ["#81ECEC", "#74B9FF"],
        moodParts: ["—É–º–∏—Ä–æ—Ç–≤–æ—Ä—ë–Ω–Ω–æ", "—É–º–∏—Ä–æ—Ç–≤–æ—Ä—ë–Ω–Ω–æ", "—É–º–∏—Ä–æ—Ç–≤–æ—Ä—ë–Ω–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "ü§î",
        gradient: ["#9fa1af", "#684989"],
        moodParts: ["–∑–∞–¥—É–º—á–∏–≤–æ", "–∑–∞–¥—É–º—á–∏–≤–æ", "–∑–∞–¥—É–º—á–∏–≤–æ–µ"],
        rating: 3
      },
      {
        emoji: "ü§®",
        gradient: ["#B2BEC3", "#636E72"],
        moodParts: ["–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ", "–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ", "–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòê",
        gradient: ["#667eea", "#764ba2"],
        moodParts: ["–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòë",
        gradient: ["#95A5A6", "#7F8C8D"],
        moodParts: ["–±–µ–∑—Ä–∞–∑–ª–∏—á–Ω–æ", "–±–µ–∑—Ä–∞–∑–ª–∏—á–Ω–æ", "–±–µ–∑—Ä–∞–∑–ª–∏—á–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üò∂",
        gradient: ["#BDC3C7", "#95A5A6"],
        moodParts: ["–º–æ–ª—á–∞–ª–∏–≤–æ", "–º–æ–ª—á–∞–ª–∏–≤–æ", "–º–æ–ª—á–∞–ª–∏–≤–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòè",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["—Ö–∏—Ç—Ä–æ", "—Ö–∏—Ç—Ä–æ", "—Ö–∏—Ç—Ä–æ–µ"],
        rating: 3
      },
      {
        emoji: "ü§ì",
        gradient: ["#74B9FF", "#0984E3"],
        moodParts: ["—É–º–Ω–æ", "—É–º–Ω–æ", "—É–º–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "üò¥",
        gradient: ["#6C5CE7", "#A29BFE"],
        moodParts: ["—Å–æ–Ω–Ω–æ", "—Å–æ–Ω–Ω–æ", "—Å–æ–Ω–Ω–æ–µ"],
        rating: 3
      },
      
      // –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 1-2)
      {
        emoji: "üòí",
        gradient: ["#74B9FF", "#0984E3"],
        moodParts: ["—Å–∫—É—á–Ω–æ", "—Å–∫—É—á–Ω–æ", "—Å–∫—É—á–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üôÑ",
        gradient: ["#A29BFE", "#6C5CE7"],
        moodParts: ["—Ä–∞–∑–¥—Ä–∞–∂—ë–Ω–Ω–æ", "—Ä–∞–∑–¥—Ä–∞–∂—ë–Ω–Ω–æ", "—Ä–∞–∑–¥—Ä–∞–∂—ë–Ω–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üò¨",
        gradient: ["#FDCB6E", "#E17055"],
        moodParts: ["–Ω–µ–ª–æ–≤–∫–æ", "–Ω–µ–ª–æ–≤–∫–æ", "–Ω–µ–ª–æ–≤–∫–æ–µ"],
        rating: 2
      },
      {
        emoji: "üòî",
        gradient: ["#74B9FF", "#0984E3"],
        moodParts: ["–ø–µ—á–∞–ª—å–Ω–æ", "–ø–µ—á–∞–ª—å–Ω–æ", "–ø–µ—á–∞–ª—å–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üòï",
        gradient: ["#636E72", "#2D3436"],
        moodParts: ["—Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω–Ω–æ", "—Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω–Ω–æ", "—Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üôÅ",
        gradient: ["#95A5A6", "#7F8C8D"],
        moodParts: ["–æ–ø–µ—á–∞–ª–µ–Ω–Ω–æ", "–æ–ø–µ—á–∞–ª–µ–Ω–Ω–æ", "–æ–ø–µ—á–∞–ª–µ–Ω–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "‚òπÔ∏è",
        gradient: ["#74B9FF", "#0984E3"],
        moodParts: ["—Ö–º—É—Ä–æ", "—Ö–º—É—Ä–æ", "—Ö–º—É—Ä–æ–µ"],
        rating: 2
      },
      {
        emoji: "üò£",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["–º—É—á–∏—Ç–µ–ª—å–Ω–æ", "–º—É—á–∏—Ç–µ–ª—å–Ω–æ", "–º—É—á–∏—Ç–µ–ª—å–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "üòñ",
        gradient: ["#FD79A8", "#E84393"],
        moodParts: ["—Å—Ç—Ä–∞–¥–∞–ª—å—á–µ—Å–∫–∏", "—Å—Ç—Ä–∞–¥–∞–ª—å—á–µ—Å–∫–∏", "—Å—Ç—Ä–∞–¥–∞–ª—å—á–µ—Å–∫–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò´",
        gradient: ["#636E72", "#2D3436"],
        moodParts: ["–∏–∑–º–æ–∂–¥—ë–Ω–Ω–æ", "–∏–∑–º–æ–∂–¥—ë–Ω–Ω–æ", "–∏–∑–º–æ–∂–¥—ë–Ω–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò©",
        gradient: ["#A29BFE", "#6C5CE7"],
        moodParts: ["—É—Å—Ç–∞–ª–æ", "—É—Å—Ç–∞–ª–æ", "—É—Å—Ç–∞–ª–æ–µ"],
        rating: 2
      },
      {
        emoji: "ü•∫",
        gradient: ["#81ECEC", "#74B9FF"],
        moodParts: ["—É–º–æ–ª—è—é—â–µ", "—É–º–æ–ª—è—é—â–µ", "—É–º–æ–ª—è—é—â–µ–µ"],
        rating: 2
      },
      {
        emoji: "üò¢",
        gradient: ["#00CEC9", "#55A3FF"],
        moodParts: ["–ø–ª–∞–∫—Å–∏–≤–æ", "–ø–ª–∞–∫—Å–∏–≤–æ", "–ø–ª–∞–∫—Å–∏–≤–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò≠",
        gradient: ["#74B9FF", "#0984E3"],
        moodParts: ["—Ä—ã–¥–∞—é—â–µ", "—Ä—ã–¥–∞—é—â–µ", "—Ä—ã–¥–∞—é—â–µ–µ"],
        rating: 1
      },
      {
        emoji: "üò§",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["—Ñ—ã—Ä–∫–∞—é—â–µ", "—Ñ—ã—Ä–∫–∞—é—â–µ", "—Ñ—ã—Ä–∫–∞—é—â–µ–µ"],
        rating: 2
      },
      {
        emoji: "üò†",
        gradient: ["#FF7675", "#E17055"],
        moodParts: ["—Å–µ—Ä–¥–∏—Ç–æ", "—Å–µ—Ä–¥–∏—Ç–æ", "—Å–µ—Ä–¥–∏—Ç–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò°",
        gradient: ["#D63031", "#74B9FF"],
        moodParts: ["—è—Ä–æ—Å—Ç–Ω–æ", "—è—Ä–æ—Å—Ç–Ω–æ", "—è—Ä–æ—Å—Ç–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "ü§¨",
        gradient: ["#2D3436", "#636E72"],
        moodParts: ["—Ä—É–≥–∞—Ç–µ–ª—å–Ω–æ", "—Ä—É–≥–∞—Ç–µ–ª—å–Ω–æ", "—Ä—É–≥–∞—Ç–µ–ª—å–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò®",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["–∏—Å–ø—É–≥–∞–Ω–Ω–æ", "–∏—Å–ø—É–≥–∞–Ω–Ω–æ", "–∏—Å–ø—É–≥–∞–Ω–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò∞",
        gradient: ["#81ECEC", "#74B9FF"],
        moodParts: ["—Ç—Ä–µ–≤–æ–∂–Ω–æ", "—Ç—Ä–µ–≤–æ–∂–Ω–æ", "—Ç—Ä–µ–≤–æ–∂–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "üò±",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["—É–∂–∞—Å–∞—é—â–µ", "—É–∂–∞—Å–∞—é—â–µ", "—É–∂–∞—Å–∞—é—â–µ–µ"],
        rating: 1
      },
      {
        emoji: "üëé",
        gradient: ["#FF7675", "#E17055"],
        moodParts: ["–Ω–µ–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ", "–Ω–µ–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ", "–Ω–µ–æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "üñï",
        gradient: ["#D63031", "#2D3436"],
        moodParts: ["–¥–µ—Ä–∑–∫–æ", "–¥–µ—Ä–∑–∫–æ", "–¥–µ—Ä–∑–∫–æ–µ"],
        rating: 2
      },
      
      // –°—Ç—Ä–∞–Ω–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 3-4)
      {
        emoji: "ü§™",
        gradient: ["#FD79A8", "#FDCB6E"],
        moodParts: ["–±–µ–∑—É–º–Ω–æ", "–±–µ–∑—É–º–Ω–æ", "–±–µ–∑—É–º–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "üòú",
        gradient: ["#00B894", "#55A3FF"],
        moodParts: ["–æ–∑–æ—Ä–Ω–æ", "–æ–∑–æ—Ä–Ω–æ", "–æ–∑–æ—Ä–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "üòù",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["–¥—Ä–∞–∑–Ω—è—â–µ", "–¥—Ä–∞–∑–Ω—è—â–µ", "–¥—Ä–∞–∑–Ω—è—â–µ–µ"],
        rating: 3
      },
      {
        emoji: "ü§ë",
        gradient: ["#00B894", "#FDCB6E"],
        moodParts: ["–∞–ª—á–Ω–æ", "–∞–ª—á–Ω–æ", "–∞–ª—á–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "ü§Ø",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["–≤–∑—Ä—ã–≤–æ–æ–ø–∞—Å–Ω–æ", "–≤–∑—Ä—ã–≤–æ–æ–ø–∞—Å–Ω–æ", "–≤–∑—Ä—ã–≤–æ–æ–ø–∞—Å–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "ü§†",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["–∫–æ–≤–±–æ–π—Å–∫–∏", "–∫–æ–≤–±–æ–π—Å–∫–∏", "–∫–æ–≤–±–æ–π—Å–∫–æ–µ"],
        rating: 4
      },
      
      // –ë–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 1-2)
      {
        emoji: "ü§í",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["–±–æ–ª—å–Ω–æ", "–±–æ–ª—å–Ω–æ", "–±–æ–ª—å–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "ü§ï",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["—Ç—Ä–∞–≤–º–∏—Ä–æ–≤–∞–Ω–Ω–æ", "—Ç—Ä–∞–≤–º–∏—Ä–æ–≤–∞–Ω–Ω–æ", "—Ç—Ä–∞–≤–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "ü§¢",
        gradient: ["#00B894", "#55A3FF"],
        moodParts: ["—Ç–æ—à–Ω–æ—Ç–≤–æ—Ä–Ω–æ", "—Ç–æ—à–Ω–æ—Ç–≤–æ—Ä–Ω–æ", "—Ç–æ—à–Ω–æ—Ç–≤–æ—Ä–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "ü§Æ",
        gradient: ["#00CEC9", "#55A3FF"],
        moodParts: ["—Ä–≤–æ—Ç–Ω–æ", "—Ä–≤–æ—Ç–Ω–æ", "—Ä–≤–æ—Ç–Ω–æ–µ"],
        rating: 1
      },
      {
        emoji: "ü§ß",
        gradient: ["#81ECEC", "#74B9FF"],
        moodParts: ["—á–∏—Ö–∞—é—â–µ", "—á–∏—Ö–∞—é—â–µ", "—á–∏—Ö–∞—é—â–µ–µ"],
        rating: 2
      },
      {
        emoji: "ü•∂",
        gradient: ["#74B9FF", "#00CEC9"],
        moodParts: ["–º–æ—Ä–æ–∑–Ω–æ", "–º–æ—Ä–æ–∑–Ω–æ", "–º–æ—Ä–æ–∑–Ω–æ–µ"],
        rating: 2
      },
      {
        emoji: "ü•µ",
        gradient: ["#E17055", "#FDCB6E"],
        moodParts: ["–∂–∞—Ä–∫–æ", "–∂–∞—Ä–∫–æ", "–∂–∞—Ä–∫–æ–µ"],
        rating: 2
      },
      
      // –ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —ç–º–æ—Ü–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥ 4-5)
      {
        emoji: "‚òÄÔ∏è",
        gradient: ["#FFEAA7", "#FDCB6E"],
        moodParts: ["—Å–æ–ª–Ω–µ—á–Ω–æ", "—Å–æ–ª–Ω–µ—á–Ω–æ", "—Å–æ–ª–Ω–µ—á–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "üåô",
        gradient: ["#74B9FF", "#6C5CE7"],
        moodParts: ["–ª—É–Ω–Ω–æ", "–ª—É–Ω–Ω–æ", "–ª—É–Ω–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "‚≠ê",
        gradient: ["#FFEAA7", "#A29BFE"],
        moodParts: ["–∑–≤—ë–∑–¥–Ω–æ", "–∑–≤—ë–∑–¥–Ω–æ", "–∑–≤—ë–∑–¥–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "üåà",
        gradient: ["#FD79A8", "#A29BFE"],
        moodParts: ["—Ä–∞–¥—É–∂–Ω–æ", "—Ä–∞–¥—É–∂–Ω–æ", "—Ä–∞–¥—É–∂–Ω–æ–µ"],
        rating: 5
      },
      {
        emoji: "üî•",
        gradient: ["#E17055", "#D63031"],
        moodParts: ["–æ–≥–Ω–µ–Ω–Ω–æ", "–æ–≥–Ω–µ–Ω–Ω–æ", "–æ–≥–Ω–µ–Ω–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "‚ùÑÔ∏è",
        gradient: ["#74B9FF", "#00CEC9"],
        moodParts: ["—Å–Ω–µ–∂–Ω–æ", "—Å–Ω–µ–∂–Ω–æ", "—Å–Ω–µ–∂–Ω–æ–µ"],
        rating: 3
      },
      {
        emoji: "‚úåÔ∏è",
        gradient: ["#00B894", "#FFEAA7"],
        moodParts: ["–º–∏—Ä–Ω–æ", "–º–∏—Ä–Ω–æ", "–º–∏—Ä–Ω–æ–µ"],
        rating: 4
      },
      {
        emoji: "ü§ò",
        gradient: ["#2D3436", "#6C5CE7"],
        moodParts: ["—Ä–æ–∫–µ—Ä—Å–∫–∏", "—Ä–æ–∫–µ—Ä—Å–∫–∏", "—Ä–æ–∫–µ—Ä—Å–∫–æ–µ"],
        rating: 4
      }
    ];

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–º–∞–π–ª–∞ —Å –≤–µ—Å–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è —Ä–µ–¥–∫–∏—Ö —Å–µ—Ç–æ–≤
    function randomEmojiObj() {
      return emojiData[Math.floor(Math.random() * emojiData.length)];
    }

    // –£–º–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å –£–í–ï–õ–ò–ß–ï–ù–ù–´–ú–ò —à–∞–Ω—Å–∞–º–∏ –Ω–∞ —Ä–µ–¥–∫–∏–µ —Å–µ—Ç—ã
    function generateSmartResult() {
      const rand = Math.random();
      
      // 22% —à–∞–Ω—Å –Ω–∞ —Ç—Ä–æ–π–∫—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö (—É–≤–µ–ª–∏—á–µ–Ω–æ —Å 15%)
      if (rand < 0.22) {
        const emoji = randomEmojiObj().emoji;
        return [emoji, emoji, emoji];
      }
      
      // 35% —à–∞–Ω—Å –Ω–∞ –ø–∞—Ä—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö (—É–≤–µ–ª–∏—á–µ–Ω–æ —Å 25%)
      if (rand < 0.57) {
        const emoji1 = randomEmojiObj().emoji;
        const emoji2 = randomEmojiObj().emoji;
        
        // –°–ª—É—á–∞–π–Ω–æ —Ä–∞–∑–º–µ—â–∞–µ–º –ø–∞—Ä—É
        const positions = [
          [emoji1, emoji1, emoji2], // –ø–∞—Ä–∞ –≤ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö
          [emoji1, emoji2, emoji1], // –ø–∞—Ä–∞ –≤ –ø–µ—Ä–≤–æ–º –∏ —Ç—Ä–µ—Ç—å–µ–º
          [emoji2, emoji1, emoji1]  // –ø–∞—Ä–∞ –≤–æ –≤—Ç–æ—Ä–æ–º –∏ —Ç—Ä–µ—Ç—å–µ–º
        ];
        
        return positions[Math.floor(Math.random() * positions.length)];
      }
      
      // 43% —à–∞–Ω—Å –Ω–∞ –æ–±—ã—á–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é (—É–º–µ–Ω—å—à–µ–Ω–æ —Å 60%)
      return [
        randomEmojiObj().emoji,
        randomEmojiObj().emoji,
        randomEmojiObj().emoji
      ];
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –ø–æ —ç–º–æ–¥–∑–∏
    function getEmojiObj(emoji) {
      return emojiData.find(obj => obj.emoji === emoji);
    }

    // –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
    function calculateMoodMetrics(emojiArray) {
      const ratings = emojiArray.map(emoji => {
        const obj = getEmojiObj(emoji);
        return obj ? obj.rating : 3;
      });
      
      const averageRating = ratings.reduce((sum, rating) => sum + rating, 0) / ratings.length;
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
      const uniqueEmojis = new Set(emojiArray).size;
      let rarityMultiplier = 1;
      
      if (uniqueEmojis === 1) {
        // –í—Å–µ —Ç—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ - –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —Ä–µ–¥–∫–æ—Å—Ç—å
        rarityMultiplier = 1.5;
      } else if (uniqueEmojis === 2) {
        // –î–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö - —ç–ø–∏—á–µ—Å–∫–∞—è —Ä–µ–¥–∫–æ—Å—Ç—å
        rarityMultiplier = 1.2;
      } else {
        // –í—Å–µ —Ä–∞–∑–Ω—ã–µ - –æ–±—ã—á–Ω–∞—è –∏–ª–∏ —Ä–µ–¥–∫–∞—è
        rarityMultiplier = 1;
      }
      
      return {
        averageRating,
        uniqueEmojis,
        finalScore: averageRating * rarityMultiplier
      };
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
    function getMoodLevel(score) {
      if (score >= 5.5) return { level: "–û–¢–õ–ò–ß–ù–û–ï", emoji: "üåü", class: "excellent" };
      if (score >= 4.5) return { level: "–•–û–†–û–®–ï–ï", emoji: "üòä", class: "good" };
      if (score >= 3) return { level: "–°–†–ï–î–ù–ï–ï", emoji: "üòê", class: "average" };
      return { level: "–ü–õ–û–•–û–ï", emoji: "üòû", class: "bad" };
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–¥–∫–æ—Å—Ç–∏
    function getRarity(uniqueEmojis, averageRating, isEpicApi) {
      if (uniqueEmojis === 1) {
        // –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ —Ç–æ–ª—å–∫–æ –¥–ª—è 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö
        return { name: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ", class: "rarity-legendary" };
      } else if (isEpicApi) {
        // –≠–ø–∏—á–µ—Å–∫–æ–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ API
        return { name: "–≠–ø–∏—á–µ—Å–∫–æ–µ", class: "rarity-epic" };
      } else if (averageRating >= 4.5) {
        return { name: "–†–µ–¥–∫–æ–µ", class: "rarity-rare" };
      } else {
        return { name: "–û–±—ã—á–Ω–æ–µ", class: "rarity-common" };
      }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, —Å—Ç–æ–∏—Ç –ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –º–∏–Ω—Ç–∞ (–¥–ª—è —Ä–µ–¥–∫–∏—Ö —Å–µ—Ç–æ–≤)
    function shouldShowMintButton(uniqueEmojis, rarityClass) {
      return uniqueEmojis <= 2 || rarityClass === "rarity-rare";
    }

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const slotEls = [
      document.getElementById('slot1'),
      document.getElementById('slot2'),
      document.getElementById('slot3')
    ];
    const spinBtn = document.getElementById('spin');
    const resultContainer = document.getElementById('resultContainer');
    const moodLevel = document.getElementById('moodLevel');
    const moodEmoji = document.getElementById('moodEmoji');
    const moodText = document.getElementById('moodText');
    const rarityBadge = document.getElementById('rarityBadge');
    const mintButtonContainer = document.getElementById('mintButtonContainer');
    const mintButton = document.getElementById('mintButton');

    // –¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –º–∏–Ω—Ç–∞
    let currentResult = null;

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–æ–Ω–∞ —Å–ª–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–º–∞–π–ª–∞
    function setSlotBackground(slotElement, emoji) {
      const emojiObj = getEmojiObj(emoji);
      if (emojiObj && emojiObj.gradient) {
        slotElement.style.background = `linear-gradient(135deg, ${emojiObj.gradient[0]}, ${emojiObj.gradient[1]})`;
      } else {
        slotElement.style.background = "linear-gradient(135deg, rgb(159 161 175), rgb(104 73 137))";
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ —Å–ª–æ—Ç–æ–≤
    function spinSlots() {
      // –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–∞—á–∞–ª–µ
      resultContainer.classList.remove('show');
      mintButtonContainer.classList.remove('show');
      spinBtn.classList.add('hidden');
      burstEmojisFromButton();
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª–æ—Ç–æ–≤
      slotEls.forEach(slot => {
        slot.classList.remove('finished');
        slot.style.filter = "grayscale(0.5)";
        slot.style.background = "linear-gradient(135deg, rgb(159 161 175), rgb(104 73 137))";
      });

      let spins = 10;
      let currentStep = 0;
      let slotsRes = ["", "", ""];

      let interval = setInterval(() => {
        currentStep++;
        // –í—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏
        slotEls.forEach(slot => {
          const randomEmoji = randomEmojiObj().emoji;
          slot.textContent = randomEmoji;
          setSlotBackground(slot, randomEmoji);
        });
        
        if (currentStep >= spins) {
          clearInterval(interval);
          // –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–º–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
          slotsRes = generateSmartResult();
          currentResult = {
            emojis: slotsRes,
            timestamp: Date.now(),
            user: 'MuKPOH758'
          };
          
          // –§–∏–∫—Å–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—ã–µ —ç–º–æ–¥–∑–∏
          slotEls.forEach((slot, index) => {
            slot.textContent = slotsRes[index];
            slot.classList.add('finished');
            slot.style.filter = "none";
            setSlotBackground(slot, slotsRes[index]);
          });
          updateBackground(slotsRes);
          showResult(slotsRes);
          setTimeout(() => {
            spinBtn.classList.remove('hidden');
          }, 200);
        }
      }, 65);
    }

    // –û—á–∏—â–∞–µ–º emoji —Å—Ä–∞–∑—É
      moodEmoji.innerHTML = '';

      // –£–¥–∞–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É/–∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ moodEmoji —Å—Ä–∞–∑—É –ø—Ä–∏ spin
      moodEmoji.innerHTML = '';

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–æ–¥–∑–∏ –≤ —Å–ª–æ—Ç–∞—Ö
    function updateBackground(arr) {
      const body = document.body;
      let colors = [];
      arr.forEach(e => {
        let obj = getEmojiObj(e);
        if (obj && obj.gradient) {
          colors.push(...obj.gradient);
        }
      });
      colors = [...new Set(colors)];
      if (!colors.length) {
        body.style.background = "linear-gradient(135deg, rgb(159 161 175), rgb(104 73 137))";
        return;
      }
      body.style.background = `linear-gradient(135deg, ${colors.join(", ")})`;
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º
    function showResult(arr) {
      const metrics = calculateMoodMetrics(arr);
      const moodLevelData = getMoodLevel(metrics.finalScore);
      let isEpicApi = false;
      let obj0 = getEmojiObj(arr[0]);
      let obj1 = getEmojiObj(arr[1]);
      let obj2 = getEmojiObj(arr[2]);
      let moodPhrase = "";
      if (arr[0] === arr[1] && arr[1] === arr[2]) {
        // 1. –î–ª—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã—Ö: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –∫–æ—Ä–æ–Ω–æ–π
        moodPhrase = `–ê–±—Å–æ–ª—é—Ç–Ω–æ ${obj0.moodParts[2]}!`;
        const emojiString = encodeURIComponent(arr[0] + '_üëë');
        const apiUrl = `https://emojik.vercel.app/s/${emojiString}?size=64`;
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º fusion loader
        playFusionLoader(arr[0], 'üëë', () => {
          fetch(apiUrl).then(resp => {
            if (resp.ok) {
              moodEmoji.innerHTML = `<img src='${apiUrl}' alt='legendary' class='emoji-fusion' style='width:64px;height:64px;vertical-align:middle;'>`;
              const img = moodEmoji.querySelector('img');
              img.addEventListener('animationend', () => {
                img.classList.remove('emoji-fusion');
              });
            } else {
              moodEmoji.textContent = moodLevelData.emoji;
            }
            const rarityData = getRarity(metrics.uniqueEmojis, metrics.averageRating, false);
            // 2. –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ rarityBadge –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "–û–±—ã—á–Ω–æ–µ"
            if (rarityData.name === '–û–±—ã—á–Ω–æ–µ') {
              rarityBadge.style.display = 'none';
            } else {
              rarityBadge.style.display = '';
              rarityBadge.textContent = rarityData.name;
              rarityBadge.className = `rarity-badge ${rarityData.class}`;
            }
          }).catch(() => {
            moodEmoji.textContent = moodLevelData.emoji;
            const rarityData = getRarity(metrics.uniqueEmojis, metrics.averageRating, false);
            if (rarityData.name === '–û–±—ã—á–Ω–æ–µ') {
              rarityBadge.style.display = 'none';
            } else {
              rarityBadge.style.display = '';
              rarityBadge.textContent = rarityData.name;
              rarityBadge.className = `rarity-badge ${rarityData.class}`;
            }
          });
        });
      } else if (metrics.uniqueEmojis === 2) {
        // –î–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∏ –æ–¥–∏–Ω –æ—Ç–ª–∏—á–Ω—ã–π
        let mainEmoji, extraEmoji;
        if (arr[0] === arr[1]) {
          mainEmoji = obj0;
          extraEmoji = obj2;
        } else if (arr[0] === arr[2]) {
          mainEmoji = obj0;
          extraEmoji = obj1;
        } else if (arr[1] === arr[2]) {
          mainEmoji = obj1;
          extraEmoji = obj0;
        } else {
          mainEmoji = obj1;
          extraEmoji = obj0;
        }
        let first = mainEmoji.moodParts[0].replace(/\s+/g, '');
        let second = extraEmoji.moodParts[2].replace(/\s+/g, '');
        first = first.charAt(0).toUpperCase() + first.slice(1);
        second = second.charAt(0).toLowerCase() + second.slice(1);
        moodPhrase = `–û—á–µ–Ω—å ${first} ‚Äî ${second}`;
        const uniqueEmojisArr = Array.from(new Set(arr));
        const emojiString = uniqueEmojisArr.join('_');
        const apiUrl = `https://emojik.vercel.app/s/${encodeURIComponent(emojiString)}?size=64`;
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º fusion loader
        playFusionLoader(uniqueEmojisArr[0], uniqueEmojisArr[1], () => {
          fetch(apiUrl).then(resp => {
            if (resp.ok) {
              isEpicApi = true;
              moodEmoji.innerHTML = `<img src='${apiUrl}' alt='${emojiString}' class='emoji-fusion' style='width:64px;height:64px;vertical-align:middle;'>`;
              const img = moodEmoji.querySelector('img');
              img.addEventListener('animationend', () => {
                img.classList.remove('emoji-fusion');
              });
            } else {
              moodEmoji.textContent = moodLevelData.emoji;
            }
            const rarityData = getRarity(metrics.uniqueEmojis, metrics.averageRating, resp.ok);
            if (rarityData.name === '–û–±—ã—á–Ω–æ–µ') {
              rarityBadge.style.display = 'none';
            } else {
              rarityBadge.style.display = '';
              rarityBadge.textContent = rarityData.name;
              rarityBadge.className = `rarity-badge ${rarityData.class}`;
            }
          }).catch(() => {
            moodEmoji.textContent = moodLevelData.emoji;
            const rarityData = getRarity(metrics.uniqueEmojis, metrics.averageRating, false);
            if (rarityData.name === '–û–±—ã—á–Ω–æ–µ') {
              rarityBadge.style.display = 'none';
            } else {
              rarityBadge.style.display = '';
              rarityBadge.textContent = rarityData.name;
              rarityBadge.className = `rarity-badge ${rarityData.class}`;
            }
          });
        });
      } else {
        // –¢—Ä–∏ —Ä–∞–∑–Ω—ã—Ö
        let x = obj0.moodParts[0].replace(/\s+/g, '');
        let y = obj1.moodParts[1].replace(/\s+/g, '');
        let z = obj2.moodParts[2].replace(/\s+/g, '');
        x = x.charAt(0).toUpperCase() + x.slice(1);
        y = y.charAt(0).toLowerCase() + y.slice(1);
        z = z.charAt(0).toLowerCase() + z.slice(1);
        moodPhrase = `${x}-${y}-${z}`;
        // –î–ª—è —Ç—Ä—ë—Ö —Ä–∞–∑–Ω—ã—Ö –≤—Å–µ–≥–¥–∞ emoji —É—Ä–æ–≤–Ω—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
        moodEmoji.textContent = moodLevelData.emoji;
        const rarityData = getRarity(metrics.uniqueEmojis, metrics.averageRating, false);
        if (rarityData.name === '–û–±—ã—á–Ω–æ–µ') {
          rarityBadge.style.display = 'none';
        } else {
          rarityBadge.style.display = '';
          rarityBadge.textContent = rarityData.name;
          rarityBadge.className = `rarity-badge ${rarityData.class}`;
        }
      }
      moodLevel.textContent = moodLevelData.level;
      moodText.textContent = moodPhrase;
      setTimeout(() => {
        resultContainer.classList.add('show');
      }, 300);
    }

    // –§—É–Ω–∫—Ü–∏—è –º–∏–Ω—Ç–∞ NFT
    function mintNFT() {
      if (!currentResult) return;
      
      mintButton.classList.add('processing');
      mintButton.innerHTML = '<span>–°–æ–∑–¥–∞–Ω–∏–µ NFT...</span>';
      
      // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∏–Ω—Ç–∞
      setTimeout(() => {
        const nftData = {
          id: `mood_${Date.now()}`,
          emojis: currentResult.emojis,
          mood: moodText.textContent,
          rarity: rarityBadge.textContent,
          timestamp: currentResult.timestamp,
          creator: currentResult.user
        };
        
        console.log('NFT —Å–æ–∑–¥–∞–Ω:', nftData);
        
        mintButton.classList.remove('processing');
        mintButton.innerHTML = '<span>‚úÖ NFT —Å–æ–∑–¥–∞–Ω!</span>';
        mintButton.style.background = 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)';
        
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
          mintButton.innerHTML = '<span>üé® –°–æ–∑–¥–∞—Ç—å NFT</span>';
          mintButton.style.background = '';
          mintButtonContainer.classList.remove('show');
        }, 3000);
        
      }, 2000);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è —ç–º–æ–¥–∑–∏ –∏–∑ –∫–Ω–æ–ø–∫–∏
    function burstEmojisFromButton() {
      for (let i = 0; i < 50; i++) {
        const emoji = document.createElement('span');
        emoji.className = 'emoji-burst';
        emoji.textContent = randomEmojiObj().emoji;
        const angle = (20 + Math.random() * 140) * (Math.PI / 180);
        const distance = 20 + Math.random() * 500;
        const x = Math.cos(angle) * distance;
        const y = Math.sin(angle) * distance + 100;
        const rot = (Math.random() * 120 - 60) + "deg";
        emoji.style.setProperty('--x', `${x}px`);
        emoji.style.setProperty('--y', `${y}px`);
        emoji.style.setProperty('--r', rot);
        document.body.appendChild(emoji);
        emoji.addEventListener('animationend', () => {
          emoji.remove();
        });
      }
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é —Å–ª–∏—è–Ω–∏—è –¥–≤—É—Ö emoji (–∏–ª–∏ emoji+üëë) –≤ moodEmoji
function playFusionLoader(emoji1, emoji2, callback) {
  moodEmoji.innerHTML =
    `<span class=\"emoji-fusion-loader\">
      <span class=\"fusion-emoji left\">${emoji1}</span>
      <span class=\"fusion-emoji right\">${emoji2}</span>
      <span class=\"fusion-magic\"></span>
    </span>`;
  // –ü–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏ "–º–∞–≥–∏–∏" (0.7s), –≤—ã–∑—ã–≤–∞–µ–º callback
  setTimeout(() => {
    if (typeof callback === 'function') callback();
  }, 850);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ–Ω–æ–≤ –¥–ª—è —Å–ª–æ—Ç–æ–≤
    slotEls.forEach(slot => {
      setSlotBackground(slot, slot.textContent);
    });

    // –°–æ–±—ã—Ç–∏—è: –∑–∞–ø—É—Å–∫ —Å–ª–æ—Ç–æ–≤ –∏ –º–∏–Ω—Ç NFT
    spinBtn.addEventListener('click', spinSlots);
    mintButton.addEventListener('click', mintNFT);
  </script>
</body>
</html>
